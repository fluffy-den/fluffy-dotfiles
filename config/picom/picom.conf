# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                     PICOM CONFIGURATION FOR i3WM                         ║
# ║                      Elegant & Modern (v12+ syntax)                      ║
# ╚══════════════════════════════════════════════════════════════════════════╝
# Save to: ~/.config/picom/picom.conf
# Launch: picom -b --config ~/.config/picom/picom.conf

# ┌──────────────────────────────────────────────────────────────────────────┐
# │                              BACKEND                                     │
# └──────────────────────────────────────────────────────────────────────────┘

backend = "xrender";
vsync = true;
glx-no-stencil = true;
glx-no-rebind-pixmap = true;
use-damage = true;
xrender-sync-fence = true;

# # ┌──────────────────────────────────────────────────────────────────────────┐
# # │                              SHADOWS                                     │
# # └──────────────────────────────────────────────────────────────────────────┘
#
# shadow = true;
# shadow-radius = 14;
# shadow-opacity = 0.35;
# shadow-offset-x = -12;
# shadow-offset-y = -12;
# shadow-color = "#000000";

# # ┌──────────────────────────────────────────────────────────────────────────┐
# # │                              FADING                                       │
# # └──────────────────────────────────────────────────────────────────────────┘
#
# fading = true;
# fade-in-step = 0.04;
# fade-out-step = 0.04;
# fade-delta = 5;
# no-fading-openclose = false;

# # ┌──────────────────────────────────────────────────────────────────────────┐
# # │                              BLUR                                         │
# # └──────────────────────────────────────────────────────────────────────────┘
#
# blur-method = "dual_kawase";
# blur-strength = 1;
# blur-background = false;
# blur-background-frame = false;
# blur-background-fixed = false;

# ┌──────────────────────────────────────────────────────────────────────────┐
# │                            ANIMATIONS (v12+)                              │
# └──────────────────────────────────────────────────────────────────────────┘

animations = (
    {
        triggers = ["open", "show"];
        preset = "appear";
        duration = 0.2;
        scale = 0.95;
    },
    {
        triggers = ["close", "hide"];
        preset = "disappear";
        duration = 0.15;
        scale = 0.95;
    },
    {
        triggers = ["geometry"];
        preset = "geometry-change";
        duration = 0.2;
    }
);

# ┌──────────────────────────────────────────────────────────────────────────┐
# │                          WINDOW RULES (v12+)                              │
# └──────────────────────────────────────────────────────────────────────────┘

rules = (
    # ── Fullscreen windows: no transparency, no rounded corners, no shadow ──
    {
        match = "fullscreen";
        opacity = 1.0;
        corner-radius = 0;
        shadow = false;
    },

    # ── Polybar: translucent with blur, no shadow ──
    {
        match = "class_g = 'Polybar'";
        opacity = 0.0;
        shadow = false;
        blur-background = false;
    },

    # ── Desktop windows: no blur ──
    {
        match = "window_type = 'desktop'";
        blur-background = false;
    },

    # ── Screenshot tool (slop): no blur ──
    {
        match = "class_g = 'slop'";
        blur-background = false;
    },

    # ── Firefox ARGB windows: no blur (fixes glitches) ──
    {
        match = "class_g = 'Firefox' && argb";
        blur-background = false;
        opacity = 1.00;
    },

    # ── GTK frame extents: no blur ──
    {
        match = "_GTK_FRAME_EXTENTS@";
        blur-background = false;
    },

    # ── Default: active windows ──
    {
        match = "focused";
        opacity = 1.00;
    },

    # ── Default: inactive windows ──
    {
        match = "!focused";
        opacity = 1.00;
    }
);

# ┌──────────────────────────────────────────────────────────────────────────┐
# │                          GENERAL SETTINGS                                 │
# └──────────────────────────────────────────────────────────────────────────┘

detect-rounded-corners = true;
detect-client-opacity = true;
detect-transient = true;
detect-client-leader = true;
use-ewmh-active-win = true;
unredir-if-possible = false;
log-level = "warn";
